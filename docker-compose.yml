---
version: '3.7'
services:
  ## MySQL Docker Compose Config
  mysql:
  image : mysql:5.7
  ports:
    - "3306:3306"
  volumes:
    - ~/db/mysql:/var/lib/mysql
    - ./config.cnf:/etc/mysql/conf.d/config.cnf
    - ./init-dump:/docker-entrypoint-initdb.d
  environment:
    TERM: xterm
    APP_ENV: dev
    MYSQL_USER: root
    MYSQL_PASSWORD: 
    MYSQL_DATABASE: clinique_db
    MYSQL_ROOT_PASSWORD: 
  container_name: mysql

  

  ## Mongo Docker Compose Config
  mongo:
    container_name: mongo
    image: mongo:4.4.14-rc0-focal
    restart: always
    ports:
      - "27017:27017"
    expose:
      - "27017"
    volumes:
      - ./mongo-data:/data/db

  

  clinique:
    container_name: clinique
    image: quay.io/clinique/clinique:18.0.0
    command: [ "start-dev", "--import-realm" ]
    environment:
      DB_VENDOR: MYSQL
      DB_ADDR: mysql
      DB_DATABASE: clinique_db
      DB_USER: root
      DB_PASSWORD: 
    ports:
      - "9110:9110"
    volumes:
      - ./realms/:/opt/keycloak/data/import/
    depends_on:
      - mysql